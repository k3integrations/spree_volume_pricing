<% display_percent ||= false %>
<% volume_prices = (product.master.volume_prices.presence || product.master.model_volume_prices) %>
<% if product.price > 0 and volume_prices.present? %>
  <div id="bulk-discount">
    <h6><%= Spree.t(:bulk_discount) %></h6>
    <table class="table table-condensed">
      <tr class="active">
        <th><%= Spree.t(:quantity) %></th>
        <th><%= Spree.t(:price) %></th>
        <% if display_percent %>
          <th><%= Spree.t(:percent) %></th>
        <% end %>
      </tr>
      <% volume_prices.each do |v| %>
        <%= content_tag(:tr) do %>
          <% if v.name.present? %>
            <%= content_tag :td, v.name %>
          <% else %>
            <%= content_tag :td, (v.open_ended? ? v.range : "#{v.range.to_range.begin}â€“#{v.range.to_range.end}") %>
          <% end %>
          <%= content_tag :td, Spree::Money.new(v.amount).to_s %>
          <%= content_tag(:td, '%i%' % ((1.0 - v.amount / product.master.price) * 100.0).round) if display_percent %>
        <% end %>
      <% end %>
    </table>
  </div>
<% end %>
